<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Batalha de Times - Mentoria Odisseia</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .battle-container { display: flex; gap: 20px; width: 100%; max-width: 1000px; margin-top: 20px; }
        .team-card { flex: 1; padding: 20px; border-radius: 10px; text-align: center; color: white; }
        .alpha-card { background: linear-gradient(135deg, #1e3a8a, #3b82f6); border: 2px solid #60a5fa; }
        .omega-card { background: linear-gradient(135deg, #7f1d1d, #ef4444); border: 2px solid #fca5a5; }
        .score-big { font-size: 3em; font-weight: bold; margin: 10px 0; }
        .stat-label { font-size: 0.9em; opacity: 0.9; }
        .vs-badge { font-size: 2em; font-weight: bold; align-self: center; color: var(--primary-green); }
    </style>
</head>
<body>
    <h1>Batalha de Times</h1>
    
    <div class="container" style="flex-direction: column; align-items: center;">
        <div class="battle-container">
            <div class="team-card alpha-card">
                <h2>TIME ALPHA</h2>
                <div class="score-big" id="alpha-questoes">0</div>
                <div class="stat-label">Quest천es Realizadas</div>
                <hr style="opacity: 0.3; margin: 15px 0;">
                <div style="font-size: 1.5em;" id="alpha-precisao">0%</div>
                <div class="stat-label">Precis찾o de Acertos</div>
            </div>

            <div class="vs-badge">VS</div>

            <div class="team-card omega-card">
                <h2>TIME OMEGA</h2>
                <div class="score-big" id="omega-questoes">0</div>
                <div class="stat-label">Quest천es Realizadas</div>
                <hr style="opacity: 0.3; margin: 15px 0;">
                <div style="font-size: 1.5em;" id="omega-precisao">0%</div>
                <div class="stat-label">Precis찾o de Acertos</div>
            </div>
        </div>
        
        <button onclick="carregarPlacar()" style="margin-top: 20px; padding: 10px 20px; cursor: pointer;">Atualizar Placar</button>
    </div>

    <a href="/" style="margin-top: 20px;">Voltar</a>

    <script>
        async function carregarPlacar() {
            try {
                const res = await fetch('/api/batalha/placar');
                const dados = await res.json();

                // Atualiza Alpha
                animateValue("alpha-questoes", 0, dados.Alpha.questoes, 1000);
                document.getElementById('alpha-precisao').innerText = dados.Alpha.precisao + "%";

                // Atualiza Omega
                animateValue("omega-questoes", 0, dados.Omega.questoes, 1000);
                document.getElementById('omega-precisao').innerText = dados.Omega.precisao + "%";

            } catch (e) { console.error(e); }
        }

        // Efeito bonitinho de contagem
        function animateValue(id, start, end, duration) {
            if (start === end) return;
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        carregarPlacar();
        // Atualiza a cada 30 segundos automaticamente
        setInterval(carregarPlacar, 30000);
    </script>
</body>
</html>